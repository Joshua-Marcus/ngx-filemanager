import * as tslib_1 from "tslib";
export var isJsons = function (array) {
    return Array.isArray(array) &&
        array.every(function (row) { return typeof row === 'object' && !(row instanceof Array); });
};
export var isArrays = function (array) {
    return Array.isArray(array) && array.every(function (row) { return Array.isArray(row); });
};
export function jsonsHeaders(array) {
    return Array.from(new Set(array.map(function (item) { return Object.keys(item); }).reduce(function (a, b) { return tslib_1.__spread(a, b); }, [])));
}
export function jsons2arrays(jsons, headers) {
    headers = headers || jsonsHeaders(jsons);
    // allow headers to have custom labels, defaulting to having the header data key be the label
    var headerLabels = headers;
    var headerKeys = headers;
    if (isJsons(headers)) {
        headerLabels = headers.map(function (header) { return header.label; });
        headerKeys = headers.map(function (header) { return header.key; });
    }
    var data = jsons.map(function (object) {
        return headerKeys.map(function (header) { return (header in object ? object[header] : ''); });
    });
    return tslib_1.__spread([headerLabels], data);
}
export var elementOrEmpty = function (element) {
    return element || element === 0 ? element : '';
};
export function joiner(data, delimiter) {
    if (delimiter === void 0) { delimiter = ','; }
    return data
        .map(function (row, index) {
        return row.map(function (element) { return '"' + elementOrEmpty(element) + '"'; }).join(delimiter);
    })
        .join("\n");
}
export function arrays2csv(data, headers, delimiter) {
    return joiner(headers ? tslib_1.__spread([headers], data) : data, delimiter);
}
export function jsons2csv(data, headers, delimiter) {
    return joiner(jsons2arrays(data, headers), delimiter);
}
export function string2csv(data, headers, delimiter) {
    return headers ? headers.join(delimiter) + "\n" + data : data;
}
export function toCSV(data, headers, delimiter) {
    if (isJsons(data)) {
        return jsons2csv(data, headers, delimiter);
    }
    if (isArrays(data)) {
        return arrays2csv(data, headers, delimiter);
    }
    if (typeof data === 'string') {
        return string2csv(data, headers, delimiter);
    }
    throw new TypeError("Data should be a \"String\", \"Array of arrays\" OR \"Array of objects\" ");
}
export function buildURI(data, uFEFF, headers, delimiter) {
    if (uFEFF === void 0) { uFEFF = true; }
    var csv = toCSV(data, headers, delimiter);
    var blob = new Blob([uFEFF ? '\uFEFF' : '', csv], { type: 'text/csv' });
    return URL.createObjectURL(blob);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BjdHJsL25neC1jc3YvIiwic291cmNlcyI6WyJ1dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFLQSxNQUFNLENBQUMsSUFBTSxPQUFPLEdBQUcsVUFBQyxLQUFZO0lBQ2xDLE9BQUEsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFDcEIsS0FBSyxDQUFDLEtBQUssQ0FBQyxVQUFBLEdBQUcsSUFBSSxPQUFBLE9BQU8sR0FBRyxLQUFLLFFBQVEsSUFBSSxDQUFDLENBQUMsR0FBRyxZQUFZLEtBQUssQ0FBQyxFQUFsRCxDQUFrRCxDQUFDO0FBRHRFLENBQ3NFLENBQUM7QUFFekUsTUFBTSxDQUFDLElBQU0sUUFBUSxHQUFHLFVBQUMsS0FBWTtJQUNuQyxPQUFBLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxVQUFBLEdBQUcsSUFBSSxPQUFBLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQWxCLENBQWtCLENBQUM7QUFBOUQsQ0FBOEQsQ0FBQztBQUVqRSxNQUFNLFVBQVUsWUFBWSxDQUFDLEtBQWU7SUFDMUMsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUNmLElBQUksR0FBRyxDQUNMLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFqQixDQUFpQixDQUFDLENBQUMsTUFBTSxDQUFDLFVBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSyx3QkFBSSxDQUFDLEVBQUssQ0FBQyxHQUFYLENBQVksRUFBRSxFQUFFLENBQUMsQ0FDeEUsQ0FDRixDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU0sVUFBVSxZQUFZLENBQzFCLEtBQWtDLEVBQ2xDLE9BQWdDO0lBRWhDLE9BQU8sR0FBRyxPQUFPLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRXpDLDZGQUE2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O0tBQ3pEO0lBQ0QsTUFBTSxJQUFJLFNBQVMsQ0FDakIsMkVBQXFFLENBQ3RFLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxVQUFVLFFBQVEsQ0FDdEIsSUFBK0QsRUFDL0QsS0FBWSxFQUNaLE9BQWdDLEVBQ2hDLFNBQWtCO0lBRmxCLHNCQUFBLEVBQUEsWUFBWTtJQUlaLElBQU0sR0FBRyxHQUFHLEtBQUssQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQzVDLElBQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBQzFFLE9BQU8sR0FBRyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNuQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBIZWFkZXJPYmoge1xuICBsYWJlbDogc3RyaW5nO1xuICBrZXk6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IGlzSnNvbnMgPSAoYXJyYXk6IGFueVtdKSA9PlxuICBBcnJheS5pc0FycmF5KGFycmF5KSAmJlxuICBhcnJheS5ldmVyeShyb3cgPT4gdHlwZW9mIHJvdyA9PT0gJ29iamVjdCcgJiYgIShyb3cgaW5zdGFuY2VvZiBBcnJheSkpO1xuXG5leHBvcnQgY29uc3QgaXNBcnJheXMgPSAoYXJyYXk6IGFueVtdKSA9PlxuICBBcnJheS5pc0FycmF5KGFycmF5KSAmJiBhcnJheS5ldmVyeShyb3cgPT4gQXJyYXkuaXNBcnJheShyb3cpKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGpzb25zSGVhZGVycyhhcnJheTogb2JqZWN0W10pIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oXG4gICAgbmV3IFNldChcbiAgICAgIGFycmF5Lm1hcChpdGVtID0+IE9iamVjdC5rZXlzKGl0ZW0pKS5yZWR1Y2UoKGEsIGIpID0+IFsuLi5hLCAuLi5iXSwgW10pLFxuICAgICksXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBqc29uczJhcnJheXMoXG4gIGpzb25zOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9W10sXG4gIGhlYWRlcnM/OiBzdHJpbmdbXSB8IEhlYWRlck9ialtdLFxuKSB7XG4gIGhlYWRlcnMgPSBoZWFkZXJzIHx8IGpzb25zSGVhZGVycyhqc29ucyk7XG5cbiAgLy8gYWxsb3cgaGVhZGVycyB0byBoYXZlIGN1c3RvbSBsYWJlbHMsIGRlZmF1bHRpbmcgdG8gaGF2aW5nIHRoZSBoZWFkZXIgZGF0YSBrZXkgYmUgdGhlIGxhYmVsXG4gIGxldCBoZWFkZXJMYWJlbHM6IHN0cmluZ1tdID0gaGVhZGVycyBhcyBzdHJpbmdbXTtcbiAgbGV0IGhlYWRlcktleXM6IHN0cmluZ1tdID0gaGVhZGVycyBhcyBzdHJpbmdbXTtcbiAgaWYgKGlzSnNvbnMoaGVhZGVycykpIHtcbiAgICBoZWFkZXJMYWJlbHMgPSAoaGVhZGVycyBhcyBIZWFkZXJPYmpbXSkubWFwKGhlYWRlciA9PiBoZWFkZXIubGFiZWwpO1xuICAgIGhlYWRlcktleXMgPSAoaGVhZGVycyBhcyBIZWFkZXJPYmpbXSkubWFwKGhlYWRlciA9PiBoZWFkZXIua2V5KTtcbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSBqc29ucy5tYXAob2JqZWN0ID0+XG4gICAgaGVhZGVyS2V5cy5tYXAoaGVhZGVyID0+IChoZWFkZXIgaW4gb2JqZWN0ID8gb2JqZWN0W2hlYWRlcl0gOiAnJykpLFxuICApO1xuICByZXR1cm4gW2hlYWRlckxhYmVscywgLi4uZGF0YV07XG59XG5cbmV4cG9ydCBjb25zdCBlbGVtZW50T3JFbXB0eSA9IChlbGVtZW50OiBhbnkpID0+XG4gIGVsZW1lbnQgfHwgZWxlbWVudCA9PT0gMCA/IGVsZW1lbnQgOiAnJztcblxuZXhwb3J0IGZ1bmN0aW9uIGpvaW5lcihkYXRhOiBhbnksIGRlbGltaXRlciA9ICcsJykge1xuICByZXR1cm4gZGF0YVxuICAgIC5tYXAoKHJvdzogYW55LCBpbmRleDogbnVtYmVyKSA9PlxuICAgICAgcm93Lm1hcCgoZWxlbWVudDogYW55KSA9PiAnXCInICsgZWxlbWVudE9yRW1wdHkoZWxlbWVudCkgKyAnXCInKS5qb2luKGRlbGltaXRlciksXG4gICAgKVxuICAgIC5qb2luKGBcXG5gKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5czJjc3YoXG4gIGRhdGE6IHN0cmluZ1tdW10sXG4gIGhlYWRlcnM/OiBzdHJpbmdbXSB8IEhlYWRlck9ialtdLFxuICBkZWxpbWl0ZXI/OiBzdHJpbmcsXG4pIHtcbiAgcmV0dXJuIGpvaW5lcihoZWFkZXJzID8gW2hlYWRlcnMsIC4uLmRhdGFdIDogZGF0YSwgZGVsaW1pdGVyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGpzb25zMmNzdihcbiAgZGF0YTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfVtdLFxuICBoZWFkZXJzPzogc3RyaW5nW10gfCBIZWFkZXJPYmpbXSxcbiAgZGVsaW1pdGVyPzogc3RyaW5nLFxuKSB7XG4gIHJldHVybiBqb2luZXIoanNvbnMyYXJyYXlzKGRhdGEsIGhlYWRlcnMpLCBkZWxpbWl0ZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nMmNzdihcbiAgZGF0YTogc3RyaW5nLFxuICBoZWFkZXJzPzogc3RyaW5nW10sXG4gIGRlbGltaXRlcj86IHN0cmluZyxcbikge1xuICByZXR1cm4gaGVhZGVycyA/IGAke2hlYWRlcnMuam9pbihkZWxpbWl0ZXIpfVxcbiR7ZGF0YX1gIDogZGF0YTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvQ1NWKFxuICBkYXRhOiBzdHJpbmcgfCBzdHJpbmdbXVtdIHwgeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfVtdIHwgYW55W10sXG4gIGhlYWRlcnM/OiBzdHJpbmdbXSB8IEhlYWRlck9ialtdLFxuICBkZWxpbWl0ZXI/OiBzdHJpbmcsXG4pIHtcbiAgaWYgKGlzSnNvbnMoZGF0YSBhcyBhbnkpKSB7XG4gICAgcmV0dXJuIGpzb25zMmNzdihkYXRhIGFzIHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH1bXSwgaGVhZGVycywgZGVsaW1pdGVyKTtcbiAgfVxuICBpZiAoaXNBcnJheXMoZGF0YSBhcyBhbnkpKSB7XG4gICAgcmV0dXJuIGFycmF5czJjc3YoZGF0YSBhcyBzdHJpbmdbXVtdLCBoZWFkZXJzLCBkZWxpbWl0ZXIpO1xuICB9XG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gc3RyaW5nMmNzdihkYXRhLCBoZWFkZXJzIGFzIHN0cmluZ1tdLCBkZWxpbWl0ZXIpO1xuICB9XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgYERhdGEgc2hvdWxkIGJlIGEgXCJTdHJpbmdcIiwgXCJBcnJheSBvZiBhcnJheXNcIiBPUiBcIkFycmF5IG9mIG9iamVjdHNcIiBgLFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRVUkkoXG4gIGRhdGE6IHN0cmluZyB8IHN0cmluZ1tdW10gfCB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9W10gfCBhbnlbXSxcbiAgdUZFRkYgPSB0cnVlLFxuICBoZWFkZXJzPzogc3RyaW5nW10gfCBIZWFkZXJPYmpbXSxcbiAgZGVsaW1pdGVyPzogc3RyaW5nLFxuKSB7XG4gIGNvbnN0IGNzdiA9IHRvQ1NWKGRhdGEsIGhlYWRlcnMsIGRlbGltaXRlcik7XG4gIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdUZFRkYgPyAnXFx1RkVGRicgOiAnJywgY3N2XSwgeyB0eXBlOiAndGV4dC9jc3YnIH0pO1xuICByZXR1cm4gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbn1cbiJdfQ==